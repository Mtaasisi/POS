<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple Customer Test</title>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
</head>
<body>
    <h1>Simple Customer Test</h1>
    <div id="results"></div>

    <script>
        const supabaseUrl = 'https://jxhzveborezjhsmzsgbc.supabase.co';
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imp4aHp2ZWJvcmV6amhzbXpzZ2JjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI3MTE1MjQsImV4cCI6MjA2ODI4NzUyNH0.pIug4PlJ3Q14GxcYilW-u0blByYoyeOfN3q9RNIjgfw';
        
        const supabase = window.supabase.createClient(supabaseUrl, supabaseKey);

        async function testSimpleCustomerFetch() {
            const resultsDiv = document.getElementById('results');
            
            try {
                // Test 1: Simple count
                console.log('Testing simple count...');
                const { count, error: countError } = await supabase
                    .from('customers')
                    .select('*', { count: 'exact', head: true });
                
                if (countError) {
                    resultsDiv.innerHTML += `<p style="color: red;">Count Error: ${countError.message}</p>`;
                } else {
                    resultsDiv.innerHTML += `<p style="color: green;">Total customers: ${count}</p>`;
                }

                // Test 2: Simple fetch with limit
                console.log('Testing simple fetch with limit 1000...');
                const { data: customers1000, error: error1000 } = await supabase
                    .from('customers')
                    .select('id, name, email, phone')
                    .limit(1000);
                
                if (error1000) {
                    resultsDiv.innerHTML += `<p style="color: red;">Fetch 1000 Error: ${error1000.message}</p>`;
                } else {
                    resultsDiv.innerHTML += `<p style="color: green;">Fetched with limit 1000: ${customers1000.length}</p>`;
                }

                // Test 3: Simple fetch without limit
                console.log('Testing simple fetch without limit...');
                const { data: customersNoLimit, error: errorNoLimit } = await supabase
                    .from('customers')
                    .select('id, name, email, phone');
                
                if (errorNoLimit) {
                    resultsDiv.innerHTML += `<p style="color: red;">Fetch no limit Error: ${errorNoLimit.message}</p>`;
                } else {
                    resultsDiv.innerHTML += `<p style="color: green;">Fetched without limit: ${customersNoLimit.length}</p>`;
                }

                // Test 4: Check if there's a default limit by fetching more
                console.log('Testing fetch with limit 2000...');
                const { data: customers2000, error: error2000 } = await supabase
                    .from('customers')
                    .select('id, name, email, phone')
                    .limit(2000);
                
                if (error2000) {
                    resultsDiv.innerHTML += `<p style="color: red;">Fetch 2000 Error: ${error2000.message}</p>`;
                } else {
                    resultsDiv.innerHTML += `<p style="color: green;">Fetched with limit 2000: ${customers2000.length}</p>`;
                }

                // Test 5: Check for any filters
                console.log('Testing fetch with is_active filter...');
                const { data: activeCustomers, error: activeError } = await supabase
                    .from('customers')
                    .select('id, name, is_active')
                    .eq('is_active', true);
                
                if (activeError) {
                    resultsDiv.innerHTML += `<p style="color: red;">Active customers Error: ${activeError.message}</p>`;
                } else {
                    resultsDiv.innerHTML += `<p style="color: green;">Active customers: ${activeCustomers.length}</p>`;
                }

                // Test 6: Check for inactive customers
                console.log('Testing fetch with inactive filter...');
                const { data: inactiveCustomers, error: inactiveError } = await supabase
                    .from('customers')
                    .select('id, name, is_active')
                    .eq('is_active', false);
                
                if (inactiveError) {
                    resultsDiv.innerHTML += `<p style="color: red;">Inactive customers Error: ${inactiveError.message}</p>`;
                } else {
                    resultsDiv.innerHTML += `<p style="color: green;">Inactive customers: ${inactiveCustomers.length}</p>`;
                }

            } catch (error) {
                resultsDiv.innerHTML += `<p style="color: red;">General error: ${error.message}</p>`;
                console.error('General error:', error);
            }
        }

        // Run the test when page loads
        window.addEventListener('load', testSimpleCustomerFetch);
    </script>
</body>
</html> 