-- Update Customers from Call Log - Chunk 12
-- This chunk contains 161 customers

-- Step 1: Create temporary table with call log data
CREATE TEMP TABLE temp_call_log_chunk_12 AS
SELECT * FROM (VALUES
('+255785088098', 'Unknown', '2025-08-26 09:46:16.000+00', '2025-08-26 09:46:16.000+00', 1, 1, 0, 0, 1.73, 1.73, 'Bronze'),
('+255758085357', 'Unknown', '2025-08-26 09:56:21.000+00', '2025-08-26 09:56:21.000+00', 1, 1, 0, 0, 1.20, 1.20, 'Bronze'),
('+255622622267', 'Unknown', '2025-08-26 10:19:07.000+00', '2025-08-26 10:19:07.000+00', 1, 1, 0, 0, 1.58, 1.58, 'Bronze'),
('+255624446039', 'Unknown', '2025-08-26 10:32:11.000+00', '2025-08-26 10:32:11.000+00', 1, 0, 0, 1, 0.00, 0.00, 'Bronze'),
('+255624133701', '+255624133701', '2025-08-26 10:42:26.000+00', '2025-08-26 10:42:26.000+00', 1, 1, 0, 0, 0.63, 0.63, 'Bronze'),
('+255713694411', 'SMkami', '2025-08-26 12:08:31.000+00', '2025-08-26 12:12:45.000+00', 2, 1, 1, 0, 0.65, 0.33, 'New'),
('+255627911732', 'Unknown', '2025-08-27 08:31:13.000+00', '2025-08-27 08:32:55.000+00', 2, 1, 1, 0, 1.10, 0.55, 'New'),
('+255757052527', 'Unknown', '2025-08-27 09:48:06.000+00', '2025-08-27 09:48:06.000+00', 1, 1, 0, 0, 1.07, 1.07, 'Bronze'),
('+255748449221', 'Unknown', '2025-08-27 09:49:45.000+00', '2025-08-27 09:50:36.000+00', 2, 0, 1, 1, 0.00, 0.00, 'New'),
('+255713777397', 'Unknown', '2025-08-27 10:12:08.000+00', '2025-08-27 10:12:08.000+00', 1, 1, 0, 0, 1.12, 1.12, 'Bronze'),
('+255655141096', '+255655141096', '2025-08-27 11:24:57.000+00', '2025-08-27 11:24:57.000+00', 1, 1, 0, 0, 0.52, 0.52, 'Bronze'),
('+255654518900', 'Unknown', '2025-08-27 11:58:50.000+00', '2025-08-27 11:58:50.000+00', 1, 1, 0, 0, 1.10, 1.10, 'Bronze'),
('+255682419992', 'Unknown', '2025-08-27 12:50:02.000+00', '2025-08-27 12:50:02.000+00', 1, 0, 1, 0, 0.60, 0.60, 'Bronze'),
('+255621648151', 'Unknown', '2025-08-27 14:30:09.000+00', '2025-08-27 14:31:06.000+00', 2, 1, 1, 0, 0.67, 0.33, 'New'),
('+255787963809', 'Unknown', '2025-08-27 15:44:36.000+00', '2025-08-27 15:44:36.000+00', 1, 0, 0, 1, 0.00, 0.00, 'Bronze'),
('+255763212106', 'SiyangaVee', '2025-08-28 09:37:55.000+00', '2025-08-28 09:40:43.000+00', 3, 0, 3, 0, 1.43, 0.48, 'New'),
('+255677595981', 'Unknown', '2025-08-28 12:26:00.000+00', '2025-08-28 12:26:57.000+00', 2, 0, 1, 1, 0.00, 0.00, 'New'),
('+255652564542', 'Unknown', '2025-08-28 13:01:29.000+00', '2025-08-28 13:01:29.000+00', 1, 1, 0, 0, 0.82, 0.82, 'Bronze'),
('+255787194716', 'Unknown', '2025-08-28 16:20:58.000+00', '2025-08-28 16:20:58.000+00', 1, 1, 0, 0, 1.00, 1.00, 'Bronze'),
('+255756051287', 'Unknown', '2025-08-29 08:30:36.000+00', '2025-08-29 08:30:36.000+00', 1, 1, 0, 0, 1.12, 1.12, 'Bronze'),
('+255653281930', 'Unknown', '2025-08-29 08:49:38.000+00', '2025-08-29 11:18:39.000+00', 5, 2, 2, 1, 2.10, 0.42, 'Basic'),
('+255760500462', 'Unknown', '2025-08-29 11:34:08.000+00', '2025-08-29 11:34:08.000+00', 1, 1, 0, 0, 0.22, 0.22, 'Bronze'),
('+255719888898', 'Unknown', '2025-08-29 12:34:55.000+00', '2025-08-29 12:36:56.000+00', 3, 2, 1, 0, 1.28, 0.43, 'New'),
('+255625839364', '+255625839364', '2025-08-29 14:38:25.000+00', '2025-08-29 14:38:25.000+00', 1, 1, 0, 0, 2.18, 2.18, 'Bronze'),
('+255785585444', 'Unknown', '2025-08-30 06:43:10.000+00', '2025-08-30 08:46:10.000+00', 2, 2, 0, 0, 2.47, 1.23, 'New'),
('+255743261734', 'Msukuma Cuttingmaster', '2025-08-30 07:32:57.000+00', '2025-08-30 07:32:57.000+00', 1, 1, 0, 0, 0.53, 0.53, 'Bronze'),
('+255714089200', '+255714089200', '2025-08-30 08:47:48.000+00', '2025-08-31 07:15:08.000+00', 9, 1, 6, 2, 5.40, 0.60, 'Basic'),
('+255682883309', 'Unknown', '2025-08-30 09:30:26.000+00', '2025-08-30 13:08:09.000+00', 7, 2, 3, 2, 9.07, 1.30, 'Basic'),
('+255712003722', 'Unknown', '2025-08-30 10:09:19.000+00', '2025-08-30 10:09:19.000+00', 1, 1, 0, 0, 1.52, 1.52, 'Bronze'),
('+255743500121', 'Unknown', '2025-08-30 10:48:45.000+00', '2025-08-30 10:48:45.000+00', 1, 1, 0, 0, 0.83, 0.83, 'Bronze'),
('+255686042917', 'Unknown', '2025-08-30 13:09:44.000+00', '2025-08-30 13:09:44.000+00', 1, 0, 0, 1, 0.00, 0.00, 'Bronze'),
('+255688923141', 'Unknown', '2025-08-30 13:17:49.000+00', '2025-08-30 13:19:28.000+00', 2, 1, 0, 1, 0.27, 0.13, 'New'),
('+255762813800', '12', '2025-08-30 14:21:26.000+00', '2025-08-30 14:21:26.000+00', 1, 0, 0, 1, 0.00, 0.00, 'Bronze'),
('+255617189609', 'Unknown', '2025-08-30 17:05:01.000+00', '2025-08-30 17:05:01.000+00', 1, 1, 0, 0, 1.60, 1.60, 'Bronze'),
('+255758463543', 'Michael Insta', '2025-08-30 17:45:53.000+00', '2025-08-30 17:45:53.000+00', 1, 0, 0, 1, 0.00, 0.00, 'Bronze'),
('+255747788257', 'Unknown', '2025-08-31 10:06:40.000+00', '2025-08-31 10:06:40.000+00', 1, 1, 0, 0, 1.35, 1.35, 'Bronze'),
('+255656953059', 'Joseph', '2025-08-31 10:23:42.000+00', '2025-09-01 06:37:50.000+00', 3, 0, 1, 2, 0.77, 0.26, 'New'),
('+255692913487', 'Unknown', '2025-08-31 11:59:05.000+00', '2025-08-31 12:02:39.000+00', 3, 2, 0, 1, 1.95, 0.65, 'New'),
('+255743922435', 'Unknown', '2025-08-31 12:50:36.000+00', '2025-08-31 15:15:21.000+00', 2, 2, 0, 0, 1.13, 0.57, 'New'),
('+255696307090', 'Unknown', '2025-08-31 14:32:00.000+00', '2025-08-31 14:32:00.000+00', 1, 1, 0, 0, 0.18, 0.18, 'Bronze'),
('+255743513099', 'Unknown', '2025-08-31 14:45:12.000+00', '2025-08-31 14:45:12.000+00', 1, 1, 0, 0, 0.75, 0.75, 'Bronze'),
('+255750041512', 'Unknown', '2025-09-01 05:19:05.000+00', '2025-09-01 05:19:05.000+00', 1, 0, 0, 1, 0.00, 0.00, 'Bronze'),
('+255754661160', 'Unknown', '2025-09-01 07:22:20.000+00', '2025-09-01 07:22:20.000+00', 1, 0, 1, 0, 0.00, 0.00, 'Bronze'),
('+255653117641', 'Unknown', '2025-09-01 08:40:41.000+00', '2025-09-01 08:40:41.000+00', 1, 1, 0, 0, 0.58, 0.58, 'Bronze'),
('+255655976637', 'Unknown', '2025-09-01 09:47:25.000+00', '2025-09-01 09:47:53.000+00', 2, 0, 1, 1, 0.07, 0.03, 'New'),
('+255745335511', 'Nazim', '2025-09-01 09:58:58.000+00', '2025-09-01 11:42:40.000+00', 2, 0, 2, 0, 1.83, 0.92, 'New'),
('+255694383848', 'Unknown', '2025-09-01 10:15:24.000+00', '2025-09-01 14:55:04.000+00', 2, 2, 0, 0, 4.20, 2.10, 'New'),
('+255682580063', 'Unknown', '2025-09-01 10:35:57.000+00', '2025-09-01 17:07:04.000+00', 5, 2, 2, 1, 5.50, 1.10, 'Basic'),
('+255716960619', 'Unknown', '2025-09-01 12:00:10.000+00', '2025-09-01 12:00:10.000+00', 1, 1, 0, 0, 0.47, 0.47, 'Bronze'),
('+255787149016', 'Unknown', '2025-09-01 12:02:12.000+00', '2025-09-02 11:08:18.000+00', 8, 3, 5, 0, 2.13, 0.27, 'Basic'),
('+255715074572', 'Lubuva', '2025-09-01 12:58:27.000+00', '2025-09-01 12:58:27.000+00', 1, 1, 0, 0, 2.48, 2.48, 'Bronze'),
('+255769232313', 'Unknown', '2025-09-01 13:08:41.000+00', '2025-09-01 13:08:41.000+00', 1, 1, 0, 0, 0.60, 0.60, 'Bronze'),
('+255789059051', 'Unknown', '2025-09-01 14:27:30.000+00', '2025-09-01 14:27:30.000+00', 1, 1, 0, 0, 1.20, 1.20, 'Bronze'),
('+255758736464', 'Unknown', '2025-09-01 14:36:57.000+00', '2025-09-02 14:43:08.000+00', 3, 2, 1, 0, 2.83, 0.94, 'New'),
('+255654289469', 'Mudricküôè', '2025-09-02 06:41:00.000+00', '2025-09-02 07:22:33.000+00', 2, 0, 2, 0, 0.70, 0.35, 'New'),
('+255684352079', 'Unknown', '2025-09-02 08:05:41.000+00', '2025-09-02 08:05:41.000+00', 1, 1, 0, 0, 1.50, 1.50, 'Bronze'),
('+255746628323', 'Unknown', '2025-09-02 09:33:16.000+00', '2025-09-02 09:36:44.000+00', 2, 2, 0, 0, 1.93, 0.97, 'New'),
('+255677772277', 'Innocent Air M1', '2025-09-02 09:46:17.000+00', '2025-09-02 09:46:17.000+00', 1, 1, 0, 0, 0.65, 0.65, 'Bronze'),
('+255745477310', 'Cairo Ô£ø', '2025-09-02 10:16:49.000+00', '2025-09-02 10:40:20.000+00', 2, 1, 1, 0, 1.55, 0.77, 'New'),
('+255777674663', 'Unknown', '2025-09-02 11:36:19.000+00', '2025-09-02 11:36:19.000+00', 1, 1, 0, 0, 1.03, 1.03, 'Bronze'),
('+255+815050506197', 'Unknown', '2025-09-02 12:46:53.000+00', '2025-09-02 12:46:53.000+00', 1, 0, 0, 1, 0.00, 0.00, 'Bronze'),
('+255783554908', 'Unknown', '2025-09-02 17:12:41.000+00', '2025-09-02 17:12:41.000+00', 1, 1, 0, 0, 0.82, 0.82, 'Bronze'),
('+255745162394', 'Unknown', '2025-09-03 05:06:46.000+00', '2025-09-03 06:44:58.000+00', 4, 1, 0, 3, 2.28, 0.57, 'New'),
('+255618434464', 'Anord', '2025-09-03 07:11:13.000+00', '2025-09-03 07:11:22.000+00', 2, 0, 2, 0, 0.00, 0.00, 'New'),
('+255769163107', 'Napster‚Äôs workshop', '2025-09-03 11:21:03.000+00', '2025-09-03 13:16:56.000+00', 4, 2, 2, 0, 2.70, 0.68, 'New'),
('+255758044470', 'Unknown', '2025-09-03 11:57:32.000+00', '2025-09-03 11:57:32.000+00', 1, 1, 0, 0, 1.10, 1.10, 'Bronze'),
('+255742568296', 'Unknown', '2025-09-03 13:05:19.000+00', '2025-09-10 14:57:56.000+00', 7, 4, 0, 3, 6.37, 0.91, 'Silver'),
('+255653603999', 'G Patric', '2025-09-03 13:57:26.000+00', '2025-09-03 13:57:26.000+00', 1, 0, 1, 0, 0.00, 0.00, 'Bronze'),
('+255653821213', 'Unknown', '2025-09-03 15:10:46.000+00', '2025-09-03 15:10:46.000+00', 1, 1, 0, 0, 1.25, 1.25, 'Bronze'),
('+255656599181', 'Unknown', '2025-09-03 18:27:07.000+00', '2025-09-04 07:27:47.000+00', 2, 0, 1, 1, 1.17, 0.58, 'New'),
('+255755343351', 'Unknown', '2025-09-04 09:12:57.000+00', '2025-09-04 11:11:47.000+00', 6, 2, 3, 1, 1.95, 0.32, 'Basic'),
('+255763826276', 'Unknown', '2025-09-04 09:39:32.000+00', '2025-09-04 09:39:32.000+00', 1, 1, 0, 0, 0.93, 0.93, 'Bronze'),
('+255656346497', 'Shreubui', '2025-09-04 10:00:19.000+00', '2025-09-04 10:00:19.000+00', 1, 1, 0, 0, 0.47, 0.47, 'Bronze'),
('+255656818778', 'Unknown', '2025-09-04 15:23:36.000+00', '2025-09-04 15:23:36.000+00', 1, 1, 0, 0, 1.48, 1.48, 'Bronze'),
('+255685923321', 'Unknown', '2025-09-04 16:16:11.000+00', '2025-09-04 16:16:11.000+00', 1, 1, 0, 0, 0.45, 0.45, 'Bronze'),
('+255794292004', 'Unknown', '2025-09-04 17:37:29.000+00', '2025-09-04 17:53:12.000+00', 4, 3, 0, 1, 3.03, 0.76, 'New'),
('+255625690866', '+255625690866', '2025-09-05 07:02:26.000+00', '2025-09-05 07:02:26.000+00', 1, 0, 1, 0, 1.52, 1.52, 'Bronze'),
('+255689419077', 'Unknown', '2025-09-05 07:18:04.000+00', '2025-09-05 07:18:04.000+00', 1, 1, 0, 0, 1.02, 1.02, 'Bronze'),
('+255765505299', 'Unknown', '2025-09-05 08:26:02.000+00', '2025-09-06 08:40:06.000+00', 3, 1, 1, 1, 4.88, 1.63, 'New'),
('+255735333833', 'Unknown', '2025-09-05 10:32:06.000+00', '2025-09-05 10:32:06.000+00', 1, 1, 0, 0, 1.35, 1.35, 'Bronze'),
('+255683176636', 'Unknown', '2025-09-05 12:51:32.000+00', '2025-09-05 12:51:32.000+00', 1, 1, 0, 0, 1.28, 1.28, 'Bronze'),
('+255717777097', 'Desdery', '2025-09-05 14:57:38.000+00', '2025-09-05 14:57:38.000+00', 1, 1, 0, 0, 0.58, 0.58, 'Bronze'),
('+255695323444', 'Unknown', '2025-09-05 16:41:57.000+00', '2025-09-05 16:46:52.000+00', 5, 2, 3, 0, 2.85, 0.57, 'Basic'),
('+255611200988', 'Unknown', '2025-09-06 04:40:05.000+00', '2025-09-06 06:11:58.000+00', 3, 0, 1, 2, 0.90, 0.30, 'New'),
('+255658474799', 'Unknown', '2025-09-06 11:41:07.000+00', '2025-09-06 11:41:07.000+00', 1, 1, 0, 0, 1.85, 1.85, 'Bronze'),
('+255754614779', 'Unknown', '2025-09-06 12:46:38.000+00', '2025-09-07 09:31:51.000+00', 5, 3, 2, 0, 3.08, 0.62, 'Basic'),
('+255762758758', 'Unknown', '2025-09-06 15:39:46.000+00', '2025-09-08 10:02:59.000+00', 3, 3, 0, 0, 2.38, 0.79, 'New'),
('+255682512332', 'Unknown', '2025-09-06 17:24:45.000+00', '2025-09-07 07:59:03.000+00', 2, 0, 1, 1, 0.92, 0.46, 'New'),
('+255788602955', 'Unknown', '2025-09-07 05:40:57.000+00', '2025-09-07 11:39:04.000+00', 7, 1, 5, 1, 1.82, 0.26, 'Basic'),
('+255765500121', 'Unknown', '2025-09-07 06:40:46.000+00', '2025-09-07 07:55:57.000+00', 2, 0, 1, 1, 0.95, 0.47, 'New'),
('+255715920061', '__ùöäùöëùöäùöãùöïùöéùöúùöú', '2025-09-07 08:20:46.000+00', '2025-09-11 11:01:06.000+00', 3, 3, 0, 0, 8.10, 2.70, 'Silver'),
('+255652913118', 'Unknown', '2025-09-07 08:37:28.000+00', '2025-09-07 08:37:28.000+00', 1, 1, 0, 0, 0.95, 0.95, 'Bronze'),
('+255678804405', 'Unknown', '2025-09-07 10:42:47.000+00', '2025-09-07 10:42:47.000+00', 1, 1, 0, 0, 1.30, 1.30, 'Bronze'),
('+255766462299', 'Unknown', '2025-09-07 18:31:42.000+00', '2025-09-08 06:02:21.000+00', 3, 0, 1, 2, 0.00, 0.00, 'New'),
('+255759009021', 'Bakari', '2025-09-08 05:33:55.000+00', '2025-09-08 15:03:08.000+00', 8, 2, 4, 2, 6.90, 0.86, 'Basic'),
('+255759148863', 'Unknown', '2025-09-08 06:20:33.000+00', '2025-09-08 06:21:12.000+00', 2, 1, 0, 1, 0.47, 0.23, 'New'),
('+255713093827', 'Unknown', '2025-09-08 08:51:40.000+00', '2025-09-08 17:42:10.000+00', 4, 4, 0, 0, 6.92, 1.73, 'New'),
('+255681363738', 'Unknown', '2025-09-08 12:30:35.000+00', '2025-09-08 15:58:09.000+00', 3, 1, 1, 1, 10.35, 3.45, 'New'),
('+255679814567', 'Unknown', '2025-09-08 14:41:46.000+00', '2025-09-08 14:41:46.000+00', 1, 1, 0, 0, 0.47, 0.47, 'Bronze'),
('+255764441409', 'Sarah Juwael', '2025-09-08 16:18:08.000+00', '2025-09-08 16:18:08.000+00', 1, 0, 0, 1, 0.00, 0.00, 'Bronze'),
('+255654874747', 'Unknown', '2025-09-08 20:28:22.000+00', '2025-09-08 20:32:16.000+00', 2, 0, 0, 2, 0.00, 0.00, 'New'),
('+255787885000', 'Unknown', '2025-09-09 13:04:34.000+00', '2025-09-09 13:09:16.000+00', 2, 1, 1, 0, 0.92, 0.46, 'New'),
('+255774587660', 'Unknown', '2025-09-09 14:36:41.000+00', '2025-09-09 14:36:41.000+00', 1, 1, 0, 0, 2.43, 2.43, 'Bronze'),
('+255752284564', 'Unknown', '2025-09-09 17:09:11.000+00', '2025-09-09 17:09:11.000+00', 1, 1, 0, 0, 0.77, 0.77, 'Bronze'),
('+255764497855', 'Djdod', '2025-09-09 18:41:26.000+00', '2025-09-09 18:41:26.000+00', 1, 1, 0, 0, 1.73, 1.73, 'Bronze'),
('+255653213802', 'Ladi Luta', '2025-09-10 06:44:59.000+00', '2025-09-11 07:30:06.000+00', 4, 4, 0, 0, 5.80, 1.45, 'New'),
('+255656343726', 'Unknown', '2025-09-10 07:52:59.000+00', '2025-09-10 07:52:59.000+00', 1, 1, 0, 0, 0.55, 0.55, 'Bronze'),
('+255624119825', 'Unknown', '2025-09-10 08:02:26.000+00', '2025-09-10 08:02:26.000+00', 1, 1, 0, 0, 0.70, 0.70, 'Bronze'),
('+255754959228', 'Mtaasisi 8855', '2025-09-10 08:51:03.000+00', '2025-09-10 08:51:03.000+00', 1, 1, 0, 0, 0.73, 0.73, 'Bronze'),
('+255765696494', 'Unknown', '2025-09-10 09:09:13.000+00', '2025-09-10 09:09:54.000+00', 2, 0, 0, 2, 0.00, 0.00, 'New'),
('+255712106677', 'Unknown', '2025-09-10 09:40:10.000+00', '2025-09-10 09:40:10.000+00', 1, 1, 0, 0, 0.52, 0.52, 'Bronze'),
('+255739715750', 'Unknown', '2025-09-10 10:50:01.000+00', '2025-09-10 10:50:01.000+00', 1, 1, 0, 0, 0.78, 0.78, 'Bronze'),
('+255682188205', 'March 2021', '2025-09-10 11:54:38.000+00', '2025-09-10 11:54:38.000+00', 1, 1, 0, 0, 0.37, 0.37, 'Bronze'),
('+255685555558', 'Unknown', '2025-09-10 12:16:23.000+00', '2025-09-10 12:16:23.000+00', 1, 1, 0, 0, 1.27, 1.27, 'Bronze'),
('+255621474774', 'Unknown', '2025-09-10 12:17:41.000+00', '2025-09-10 12:17:41.000+00', 1, 1, 0, 0, 0.90, 0.90, 'Bronze'),
('+255718826867', '(Update)', '2025-09-10 15:43:23.000+00', '2025-09-10 15:43:23.000+00', 1, 1, 0, 0, 0.85, 0.85, 'Bronze'),
('+255713220681', 'Unknown', '2025-09-10 16:08:57.000+00', '2025-09-10 16:12:44.000+00', 2, 1, 1, 0, 1.55, 0.77, 'New'),
('+255762300560', 'Kelvin Mdee', '2025-09-10 17:03:32.000+00', '2025-09-10 17:31:57.000+00', 3, 3, 0, 0, 5.05, 1.68, 'New'),
('+255717043713', 'Unknown', '2025-09-10 17:18:01.000+00', '2025-09-10 17:18:01.000+00', 1, 1, 0, 0, 1.58, 1.58, 'Bronze'),
('+255787666406', 'Unknown', '2025-09-10 17:34:55.000+00', '2025-09-11 06:28:44.000+00', 8, 3, 5, 0, 3.27, 0.41, 'Basic'),
('+255754317803', 'Unknown', '2025-09-11 05:56:03.000+00', '2025-09-11 05:56:03.000+00', 1, 1, 0, 0, 0.32, 0.32, 'Bronze'),
('+255652067211', 'Unknown', '2025-09-11 06:39:54.000+00', '2025-09-11 06:39:54.000+00', 1, 1, 0, 0, 1.32, 1.32, 'Bronze'),
('+255623981325', 'Unknown', '2025-09-11 08:12:37.000+00', '2025-09-11 08:13:08.000+00', 2, 1, 1, 0, 0.12, 0.06, 'New'),
('+255785057393', 'Betrum Humphrey', '2025-09-11 08:43:50.000+00', '2025-09-11 08:44:16.000+00', 3, 2, 1, 0, 2.02, 0.67, 'New'),
('+255696899441', 'Yusuph Camel Reception', '2025-09-11 13:37:54.000+00', '2025-09-11 13:41:01.000+00', 2, 1, 0, 1, 0.90, 0.45, 'New'),
('+255776556557', 'Unknown', '2025-09-11 15:47:20.000+00', '2025-09-11 15:47:20.000+00', 1, 1, 0, 0, 0.70, 0.70, 'Bronze'),
('+255699443486', 'Cathelin', '2025-09-12 08:25:24.000+00', '2025-09-12 08:26:39.000+00', 2, 1, 1, 0, 1.73, 0.87, 'New'),
('+255768301993', 'Unknown', '2025-09-12 10:14:34.000+00', '2025-09-12 10:39:22.000+00', 2, 0, 1, 1, 0.00, 0.00, 'New'),
('+255612415145', 'Unknown', '2025-09-12 10:16:15.000+00', '2025-09-12 10:16:15.000+00', 1, 1, 0, 0, 1.18, 1.18, 'Bronze'),
('+255615941415', 'Unknown', '2025-09-12 13:18:24.000+00', '2025-09-12 13:18:24.000+00', 1, 1, 0, 0, 0.63, 0.63, 'Bronze'),
('+255684101522', 'Nimo''s Trendtz', '2025-09-12 15:05:48.000+00', '2025-09-12 15:05:48.000+00', 1, 1, 0, 0, 0.23, 0.23, 'Bronze'),
('+255628087753', 'Unknown', '2025-09-13 08:43:43.000+00', '2025-09-13 08:48:26.000+00', 2, 0, 1, 1, 0.28, 0.14, 'New'),
('+255626020580', 'Unknown', '2025-09-13 08:42:55.000+00', '2025-09-15 08:55:58.000+00', 6, 4, 1, 1, 8.42, 1.40, 'Silver'),
('+255712573269', 'Allen.M', '2025-09-13 12:00:00.000+00', '2025-09-13 12:00:00.000+00', 1, 1, 0, 0, 0.47, 0.47, 'Bronze'),
('+255717982635', 'Unknown', '2025-09-14 08:21:53.000+00', '2025-09-14 08:24:18.000+00', 2, 1, 0, 1, 1.32, 0.66, 'New'),
('+255755538496', 'Unknown', '2025-09-14 08:55:05.000+00', '2025-09-14 08:55:05.000+00', 1, 1, 0, 0, 0.38, 0.38, 'Bronze'),
('+255755495473', 'Luckson Mwampaja', '2025-09-14 10:19:32.000+00', '2025-09-15 14:58:31.000+00', 3, 3, 0, 0, 2.97, 0.99, 'New'),
('+255620697027', 'Maiko Macho', '2025-09-14 12:40:09.000+00', '2025-09-14 12:40:09.000+00', 1, 1, 0, 0, 1.20, 1.20, 'Bronze'),
('+255717733451', 'Unknown', '2025-09-14 13:24:01.000+00', '2025-09-14 13:24:01.000+00', 1, 1, 0, 0, 1.12, 1.12, 'Bronze'),
('+255766918429', 'El V√†≈Ñ≈Ñ√≠√®', '2025-09-14 15:32:07.000+00', '2025-09-14 15:42:36.000+00', 2, 0, 1, 1, 1.77, 0.88, 'New'),
('+255625506374', 'Unknown', '2025-09-15 08:25:10.000+00', '2025-09-15 08:25:10.000+00', 1, 1, 0, 0, 0.77, 0.77, 'Bronze'),
('+255614957518', 'Unknown', '2025-09-15 09:22:49.000+00', '2025-09-15 09:32:02.000+00', 2, 2, 0, 0, 1.72, 0.86, 'New'),
('+255717010410', 'H 6p', '2025-09-15 10:06:45.000+00', '2025-09-15 10:06:45.000+00', 1, 1, 0, 0, 0.68, 0.68, 'Bronze'),
('+255747462175', 'Abraham Twist', '2025-09-15 12:49:26.000+00', '2025-09-15 12:56:31.000+00', 2, 1, 1, 0, 2.48, 1.24, 'New'),
('+255743152525', 'Unknown', '2025-09-15 14:38:50.000+00', '2025-09-15 14:38:50.000+00', 1, 1, 0, 0, 1.23, 1.23, 'Bronze'),
('+255768637856', 'Unknown', '2025-09-15 14:42:25.000+00', '2025-09-15 14:42:25.000+00', 1, 1, 0, 0, 1.35, 1.35, 'Bronze'),
('+255755461147', 'Unknown', '2025-09-15 15:33:32.000+00', '2025-09-15 15:33:32.000+00', 1, 1, 0, 0, 2.85, 2.85, 'Bronze'),
('+255715410008', 'Unknown', '2025-09-15 17:34:35.000+00', '2025-09-15 17:34:35.000+00', 1, 1, 0, 0, 1.87, 1.87, 'Bronze'),
('+255750360926', 'Unknown', '2025-09-16 05:25:34.000+00', '2025-09-16 05:25:34.000+00', 1, 1, 0, 0, 2.13, 2.13, 'Bronze'),
('+255752666614', 'Traceit Africa Ltd', '2025-09-16 05:49:45.000+00', '2025-09-16 05:49:45.000+00', 1, 1, 0, 0, 0.32, 0.32, 'Bronze'),
('+255712963774', 'Farida Staff', '2025-09-16 05:52:22.000+00', '2025-09-16 09:53:58.000+00', 6, 5, 1, 0, 8.27, 1.38, 'Basic'),
('+255676869092', 'Unknown', '2025-09-16 06:41:44.000+00', '2025-09-16 06:51:09.000+00', 4, 4, 0, 0, 3.35, 0.84, 'New'),
('+255672901323', 'Unknown', '2025-09-16 08:34:48.000+00', '2025-09-16 08:34:48.000+00', 1, 1, 0, 0, 1.22, 1.22, 'Bronze'),
('+255689616523', 'Unknown', '2025-09-16 13:43:48.000+00', '2025-09-16 13:43:48.000+00', 1, 1, 0, 0, 2.08, 2.08, 'Bronze'),
('+255762003033', 'Hariri Tom', '2025-09-16 14:24:35.000+00', '2025-09-16 14:54:48.000+00', 4, 2, 2, 0, 5.05, 1.26, 'New'),
('+255712549111', 'Ney', '2025-09-16 15:01:45.000+00', '2025-09-16 15:48:22.000+00', 3, 3, 0, 0, 1.72, 0.57, 'New'),
('+255755643928', 'Unknown', '2025-09-16 18:27:31.000+00', '2025-09-16 18:29:09.000+00', 3, 1, 1, 1, 0.72, 0.24, 'New'),
('+255766677618', 'Unknown', '2025-09-17 06:35:12.000+00', '2025-09-17 06:35:12.000+00', 1, 1, 0, 0, 4.13, 4.13, 'Bronze'),
('+255717725454', 'Mesud Luqman', '2025-09-17 07:06:30.000+00', '2025-09-17 07:13:59.000+00', 2, 1, 1, 0, 3.43, 1.72, 'New'),
('+255717507540', '+255717507540', '2025-09-17 09:25:43.000+00', '2025-09-17 09:25:43.000+00', 1, 1, 0, 0, 0.32, 0.32, 'Bronze'),
('+255622855664', 'Unknown', '2025-09-17 13:54:03.000+00', '2025-09-17 14:44:54.000+00', 6, 3, 1, 2, 1.87, 0.31, 'Basic')
) AS call_data(phone, best_name, first_call_date, last_call_date, total_calls, incoming_calls, outgoing_calls, missed_calls, total_duration_minutes, avg_duration_minutes, loyalty_level);

-- Step 2: Update existing customers
UPDATE customers SET
    name = CASE WHEN customers.name = '__' OR customers.name IS NULL OR LENGTH(t.best_name) > LENGTH(customers.name) THEN t.best_name ELSE customers.name END,
    created_at = COALESCE(t.first_call_date::timestamp, customers.created_at),
    total_calls = t.total_calls,
    total_call_duration_minutes = t.total_duration_minutes,
    incoming_calls = t.incoming_calls,
    outgoing_calls = t.outgoing_calls,
    missed_calls = t.missed_calls,
    avg_call_duration_minutes = t.avg_duration_minutes,
    first_call_date = t.first_call_date::timestamp,
    last_call_date = t.last_call_date::timestamp,
    call_loyalty_level = t.loyalty_level,
    last_visit = t.last_call_date::timestamp,
    updated_at = NOW()
FROM temp_call_log_chunk_12 t
WHERE customers.phone = t.phone;

-- Step 3: Show results for this chunk
SELECT 
    'Chunk 12 Results:' as info,
    COUNT(*) as customers_updated
FROM customers 
WHERE updated_at > NOW() - INTERVAL '1 minute';

-- Step 4: Drop temporary table
DROP TABLE temp_call_log_chunk_12;
